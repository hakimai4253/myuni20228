<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>公主的魔法更衣室</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #ffeaa7;
            --deep-pink: #e84393;
            --light-pink: #fab1a0;
            --purple: #6c5ce7;
            --pixel-font: 'VT323', monospace;
            /* 新增：好讀的圓滑字體，適合閱讀中文 */
            --reading-font: "Microsoft JhengHei", "微軟正黑體", "Heiti TC", "黑體-繁", sans-serif;
        }

        img { image-rendering: pixelated; }

        body {
            font-family: var(--reading-font); /* 預設改用好讀字體 */
            background-color: var(--bg-color);
            background-image: radial-gradient(var(--light-pink) 15%, transparent 16%), radial-gradient(var(--light-pink) 15%, transparent 16%);
            background-size: 20px 20px;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            user-select: none; 
            -webkit-user-select: none;
        }

        .game-boy {
            background-color: #fff0f5;
            width: 95%;
            max-width: 600px;
            height: 90vh;
            border-radius: 20px;
            border: 4px solid var(--purple);
            box-shadow: 10px 10px 0px rgba(108, 92, 231, 0.4);
            display: flex;
            flex-direction: column;
            position: relative;
            padding: 10px;
            box-sizing: border-box;
        }

        .screen-container {
            background-color: #ffe0e9;
            border: 4px solid var(--purple);
            border-radius: 10px;
            flex: 1;
            overflow-y: auto;
            position: relative;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }

        .screen-section {
            display: none;
            width: 100%;
            height: 100%;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            animation: fadeIn 0.5s;
        }
        .screen-section.active { display: flex; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- 公主舞台 --- */
        .princess-stage {
            width: 260px;
            height: 360px;
            background: #fff;
            border: 4px solid gold;
            border-radius: 20px; 
            position: relative;
            margin: 10px auto;
            overflow: hidden;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .layer-base-img { width: 100%; height: 100%; object-fit: contain; z-index: 1; }
        
        .layer {
            position: absolute;
            transition: all 0.5s;
            opacity: 0; 
            filter: grayscale(0%) drop-shadow(0px 0px 5px gold);
            pointer-events: none;
        }
        .layer.unlocked { opacity: 1; animation: popIn 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        .layer-dress { top: 20px; right: 10px; font-size: 50px; z-index: 5; }
        .layer-shoes { bottom: 10px; right: 10px; font-size: 40px; z-index: 5; }
        .layer-hair { top: 10px; left: 10px; font-size: 50px; z-index: 5; }
        .layer-wand { top: 50%; right: 5px; font-size: 50px; z-index: 6; }
        .layer-pet { bottom: 10px; left: 10px; font-size: 60px; z-index: 6; }
        .layer-crown { top: -10px; left: 50%; transform: translateX(-50%); font-size: 60px; z-index: 7; }

        @keyframes popIn { 0% { transform: scale(0); } 80% { transform: scale(1.2); } 100% { transform: scale(1); } }

        /* UI 元件優化 */
        h1, h2 { 
            color: var(--deep-pink); 
            margin: 5px 0; 
            text-shadow: 2px 2px 0 #fff; 
            font-family: var(--reading-font); /* 標題改用好讀字體 */
            font-weight: bold;
        }
        
        /* 按鈕保持一點像素感，但字體好讀 */
        .pixel-btn {
            background-color: var(--deep-pink);
            border: 3px solid #000;
            color: #fff;
            padding: 12px 25px;
            font-family: var(--reading-font);
            font-weight: bold;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 4px 4px 0px rgba(0,0,0,0.3);
            margin: 15px;
            border-radius: 12px;
            touch-action: manipulation;
            transition: all 0.1s;
        }
        .pixel-btn:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0px rgba(0,0,0,0.3); }
        
        .input-box {
            font-family: var(--reading-font);
            font-size: 1.5rem;
            padding: 10px;
            border: 3px solid var(--purple);
            border-radius: 10px;
            text-align: center;
            width: 80%;
            margin: 10px 0;
            background: #fff;
        }

        .avatar-select { display: flex; gap: 15px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .avatar-opt { 
            width: 80px; height: 80px; cursor: pointer; border: 4px solid #fff; border-radius: 15px; 
            padding: 5px; background: var(--light-pink); transition: all 0.2s; box-shadow: 3px 3px 0px rgba(0,0,0,0.1); object-fit: contain; background-color: #fff;
        }
        .avatar-opt.selected { border-color: var(--deep-pink); transform: scale(1.1) translateY(-3px); box-shadow: 5px 5px 0px rgba(232, 67, 147, 0.4); background-color: #ffeaa7; }

        /* 題目區大幅優化 */
        .quiz-panel { width: 100%; text-align: left; padding-bottom:
